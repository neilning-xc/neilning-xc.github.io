<!DOCTYPE html>
<html lang="zh-CN">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="Tell the world with code"/>
    

    <!--Author-->
    
        <meta name="author" content="Neil Ning"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="使用React实现自定义的浏览器滚动条"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Tell the world with code"/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="Neil的博客"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="https://neilning-xc.github.io/img/banner.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="https://neilning-xc.github.io/img/banner.jpg"/>
    

    <!-- Title -->
    
    <title>使用React实现自定义的浏览器滚动条 - Neil的博客</title>

    <!-- Bootstrap Core CSS -->
    <link href="//lib.baomitu.com/twitter-bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//lib.baomitu.com/featherlight/1.3.5/featherlight.min.css" rel="stylesheet"/>

    <!-- Google Analytics -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPEMLKFYYW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ZPEMLKFYYW');
    </script>



    <!-- favicon -->
    

<meta name="generator" content="Hexo 5.4.2"></head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Neil的博客</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                首页
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                归档
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                标签
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                分类
                            
                        </a>
                    </li>
                
                    <li>
                        <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/neilning-xc/neilning-xc.github.io">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header post-header" style="background-image: url('使用React实现自定义的浏览器滚动条/bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>使用React实现自定义的浏览器滚动条</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                            Posted by Neil Ning on
                        
                        
                            2025-01-17
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/React/">#React</a> <a href="/tags/scrollbar/">#scrollbar</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                        

<a href="/categories/学习/">学习</a>

                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h1 id="React自定义滚动条"><a href="#React自定义滚动条" class="headerlink" title="React自定义滚动条"></a>React自定义滚动条</h1><p>开发Web应用时，有时候我们会遇到需要自定义滚动条的情况。比如在一个长列表中或者侧边的导航栏中，我们希望滚动条的样式和颜色能够和整体风格保持一致，这时我们就需要自定义滚动条。自定义滚动条的方法大致有两种，比如通过CSS样式和JavaScript代码。</p>
<h2 id="通过CSS自定义滚动条"><a href="#通过CSS自定义滚动条" class="headerlink" title="通过CSS自定义滚动条"></a>通过CSS自定义滚动条</h2><p>首先，最简单的方案就是通过CSS设置滚动条的样式。我们可以通过<code>::-webkit-scrollbar</code>伪类来设置滚动条的样式。可以设置的部分有滚动条有水平滚动条和垂直滚动条，滚动条的轨道，滚动条的滑块等。示例代码如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 设置滚动条的样式 */</span></span><br><span class="line"><span class="selector-class">.scrollbar</span>::-webkit-scrollbar &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">10px</span>; <span class="comment">/* 设置滚动条的宽度 */</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">10px</span>; <span class="comment">/* 设置滚动条的高度 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设置滚动条的轨道样式 */</span></span><br><span class="line"><span class="selector-class">.scroll</span>::-webkit-scrollbar-track &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f1f1f1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设置滚动条的滑块样式 */</span></span><br><span class="line"><span class="selector-class">.scroll</span>::-webkit-scrollbar-thumb &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#888</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设置滚动条的滑块悬停样式 */</span></span><br><span class="line"><span class="selector-class">.scroll</span>::-webkit-scrollbar-thumb:hover &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#555</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设置滚动条的滑块激活样式 */</span></span><br><span class="line"><span class="selector-class">.scroll</span>::-webkit-scrollbar-thumb:active &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#555</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设置水平和垂直滚动条交界处的样式 */</span></span><br><span class="line"><span class="selector-class">.scroll</span>::-webkit-scroll-corner &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f1f1f1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上伪类带有-webkit前缀，所以只能在webkit内核的浏览器中生效，比如Chrome、Safari等。对其他浏览器如Firefox和IE，就需要考虑其他方案了，需要JS和CSS配合实现。</p>
<h2 id="通过JS和CSS自定义滚动条"><a href="#通过JS和CSS自定义滚动条" class="headerlink" title="通过JS和CSS自定义滚动条"></a>通过JS和CSS自定义滚动条</h2><p>由于CSS设置滚动条样式的兼容性较差，所以实际项目中基本无法采用上面的方式。这就需要我们通过JS和CSS配合来实现自定义滚动条。主要思路是创建一个模拟的滚条，然后通过JS来监听滚动事件，动态修改模拟滚动条滑块的位置，然后通过CSS隐藏浏览器原生滚动条。</p>
<p>下面通过React实现一个模拟滚动条，首先通过vite快速初始化一个React项目，我们先从最常见的垂直滚动条开始，创建一个Scroll组件，其基本结构如下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useState, useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./scrollbar.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Scrollbar</span> = (<span class="params">&#123;children, height&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> outerRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> innerRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [scrollHeight, setScrollHeight] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleScroll</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-container&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;height&#125;&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-vertical-track&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;vertical-thumb&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">scrollHeight</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&#123;outerRef&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&quot;scrollbar-outer&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onScroll</span>=<span class="string">&#123;handleScroll&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-inner&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;innerRef&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>scrollbar.css的内容如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.scrollbar-container</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.scrollbar-container</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.scrollbar-vertical-track</span>  &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.scrollbar-vertical-track</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ff9d0036</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">0.25s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.vertical-thumb</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">background</span>: gray;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.scrollbar-outer</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line">  <span class="comment">/* 在元素上滚动时避免外部容器滚动 */</span></span><br><span class="line">  overscroll-behavior: contain;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.scrollbar-inner</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">  <span class="attribute">width</span>: fit-content;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后创建一个demo组件，使用Scrollbar组件，如下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Scrollbar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./component/Scrollbar&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;app&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Scrollbar</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">height</span>=<span class="string">&#123;200&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">1200</span>, <span class="attr">height:</span> <span class="attr">1200</span>, <span class="attr">background:</span> &#x27;<span class="attr">linear-gradient</span>(<span class="attr">135deg</span>, #<span class="attr">646cff</span>, #<span class="attr">f6ff64</span>)&#x27; &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Scrollbar</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<h2 id="设置滑块的高度"><a href="#设置滑块的高度" class="headerlink" title="设置滑块的高度"></a>设置滑块的高度</h2><p>首先我们要根据容器和内容的高度计算出滑块的高度，在组件中添加以下代码：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Scrollbar</span> = (<span class="params">&#123;children, height&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 其他代码省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> outerRect = <span class="title function_">useRef</span>(&#123; <span class="attr">height</span>: <span class="number">0</span>, <span class="attr">width</span>: <span class="number">0</span> &#125;);</span><br><span class="line">  <span class="keyword">const</span> innerRect = <span class="title function_">useRef</span>(&#123; <span class="attr">height</span>: <span class="number">0</span>, <span class="attr">width</span>: <span class="number">0</span> &#125;);</span><br><span class="line">  <span class="keyword">const</span> scaleY = <span class="title function_">useRef</span>(<span class="number">0</span>); <span class="comment">// 存储比例，供后面使用</span></span><br><span class="line">  <span class="keyword">const</span> [scrollHeight, setScrollHeight] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 1. 计算垂直滑块的高度</span></span><br><span class="line">    <span class="keyword">const</span> outer = outerRef.<span class="property">current</span>;</span><br><span class="line">    <span class="keyword">const</span> inner = innerRef.<span class="property">current</span>;</span><br><span class="line">    <span class="keyword">if</span> (outer &amp;&amp; inner) &#123;</span><br><span class="line">        outerRect.<span class="property">current</span> = &#123; <span class="attr">height</span>: outer.<span class="property">clientHeight</span>, <span class="attr">width</span>: outer.<span class="property">clientWidth</span> &#125;;</span><br><span class="line">        innerRect.<span class="property">current</span> = &#123; <span class="attr">height</span>: inner.<span class="property">clientHeight</span>, <span class="attr">width</span>: inner.<span class="property">clientWidth</span> &#125;;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 使用百分比计算滚动条的宽度和高度</span></span><br><span class="line">      <span class="title function_">setScrollHeight</span>(outer.<span class="property">clientHeight</span> / inner.<span class="property">clientHeight</span> * <span class="number">100</span> + <span class="string">&#x27;%&#x27;</span>);</span><br><span class="line">      <span class="keyword">const</span> thumbHeight = outer.<span class="property">clientHeight</span> / inner.<span class="property">clientHeight</span> * outer.<span class="property">clientHeight</span>;</span><br><span class="line">      scaleY.<span class="property">current</span> = (innerRect.<span class="property">current</span>.<span class="property">height</span> - outerRect.<span class="property">current</span>.<span class="property">height</span>) / (outerRect.<span class="property">current</span>.<span class="property">height</span> - thumbHeight);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [outerRef.<span class="property">current</span>, innerRef.<span class="property">current</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-container&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;height&#125;&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-vertical-track&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;vertical-thumb&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">scrollHeight</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&#123;outerRef&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&quot;scrollbar-outer&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onScroll</span>=<span class="string">&#123;handleScroll&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-inner&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;innerRef&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="设置滑块的位置"><a href="#设置滑块的位置" class="headerlink" title="设置滑块的位置"></a>设置滑块的位置</h2><p>紧接着要处理滚动事件，在滚动事件中设置模拟滚动条滑块的位置，计算滑块的位置主要通过scrollTop和百分比计算，然后通过translateY来修改滑块的位置，代码如下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Scrollbar</span> = (<span class="params">&#123;children, height&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 其他代码省略...</span></span><br><span class="line">  <span class="keyword">const</span> [translateY, setTranslateY] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleScroll</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 2. 滚动时计算滑块的位置</span></span><br><span class="line">    <span class="keyword">const</span> &#123;height&#125; = outerRect.<span class="property">current</span>;</span><br><span class="line">    <span class="comment">// 通过百分比的计算方式最为简单</span></span><br><span class="line">    <span class="keyword">const</span> y = e.<span class="property">currentTarget</span>.<span class="property">scrollTop</span> / height * <span class="number">100</span> + <span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">    <span class="title function_">setTranslateY</span>(y);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-container&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;height&#125;&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-vertical-track&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;vertical-thumb&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">scrollHeight</span>, <span class="attr">transform:</span> `<span class="attr">translateY</span>($&#123;<span class="attr">translateY</span>&#125;)` &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&#123;outerRef&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&quot;scrollbar-outer&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onScroll</span>=<span class="string">&#123;handleScroll&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-inner&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;innerRef&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="滑轨点击事件"><a href="#滑轨点击事件" class="headerlink" title="滑轨点击事件"></a>滑轨点击事件</h2><p>接下来要处理的另外一个效果是滑轨点击事件，即点击滑轨的某个位置时，能够直接滚动到相应的位置。但是为了能完全还原原生滚动条的效果，我们不使用click事件，而是使用mouseDown事件，即鼠标按下时就执行滚动操作。代码如下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Scrollbar</span> = (<span class="params">&#123;children, height&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 其他代码省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. 滑轨点击事件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleVerticalTrackMouseDown</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">height</span>: outerH &#125; = outerRect.<span class="property">current</span>;</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">height</span>: innerH &#125; = innerRect.<span class="property">current</span>;</span><br><span class="line">    <span class="comment">// 获取点击时，在滚动条上的位置</span></span><br><span class="line">    <span class="keyword">const</span> offset = e.<span class="property">clientY</span> - e.<span class="property">currentTarget</span>.<span class="title function_">getBoundingClientRect</span>().<span class="property">top</span>;</span><br><span class="line">    <span class="keyword">const</span> scrollTop = offset / outerH * innerH - outerH / <span class="number">2</span>;</span><br><span class="line">    outerRef.<span class="property">current</span>.<span class="property">scrollTop</span> = scrollTop;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 其他代码省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-container&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;height&#125;&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-vertical-track&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleVerticalTrackMouseDown&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;vertical-thumb&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">scrollHeight</span>, <span class="attr">transform:</span> `<span class="attr">translateY</span>($&#123;<span class="attr">translateY</span>&#125;)` &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&#123;outerRef&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&quot;scrollbar-outer&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onScroll</span>=<span class="string">&#123;handleScroll&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-inner&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;innerRef&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="滑块拖拽事件"><a href="#滑块拖拽事件" class="headerlink" title="滑块拖拽事件"></a>滑块拖拽事件</h2><p>最后要模拟的行为是拖动滑块，执行滚动操作，这里则需要用到mouseDown、mouseMove和mouseUp事件，代码如下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Scrollbar</span> = (<span class="params">&#123;children, height&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 其他代码省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断是否按下鼠标</span></span><br><span class="line">  <span class="keyword">const</span> verticalMouseDown = <span class="title function_">useRef</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="comment">// 记录按下鼠标时指针的位置</span></span><br><span class="line">  <span class="keyword">const</span> startY = <span class="title function_">useRef</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 记录按下鼠标时，已经滚动的距离</span></span><br><span class="line">  <span class="keyword">const</span> startScrollTop = <span class="title function_">useRef</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4.滑块拖拽事件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleVerticalThumbMouseDown</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 阻止默认行为, 防止选中文本</span></span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="comment">// 阻止事件冒泡, 防止触发滑轨点击事件</span></span><br><span class="line">    e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">    verticalMouseDown.<span class="property">current</span> = <span class="literal">true</span>;</span><br><span class="line">    startY.<span class="property">current</span> = e.<span class="property">clientY</span>;</span><br><span class="line">    startScrollTop.<span class="property">current</span> = outerRef.<span class="property">current</span>.<span class="property">scrollTop</span>;</span><br><span class="line">    <span class="comment">// 在window上增加move事件，鼠标移动出滑轨的区域仍然有效</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, handleMouseMove);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, handleMouseUp);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleMouseMove</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 阻止默认行为, 防止选中文本</span></span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="keyword">if</span> (verticalMouseDown.<span class="property">current</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> offsetY = e.<span class="property">clientY</span> - startY.<span class="property">current</span>;</span><br><span class="line">      outerRef.<span class="property">current</span>.<span class="property">scrollTop</span> = startScrollTop.<span class="property">current</span> + offsetY * scaleY.<span class="property">current</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleMouseUp</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (verticalMouseDown.<span class="property">current</span>) &#123;</span><br><span class="line">      verticalMouseDown.<span class="property">current</span> = <span class="literal">false</span>;</span><br><span class="line">      startY.<span class="property">current</span> = <span class="number">0</span>;</span><br><span class="line">      <span class="comment">// 结束后移除事件监听，防止其他bug产生</span></span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, handleMouseMove);</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, handleMouseUp);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 其他代码省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-container&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;height&#125;&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-vertical-track&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleVerticalTrackMouseDown&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;vertical-thumb&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleVerticalThumbMouseDown&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">scrollHeight</span>, <span class="attr">transform:</span> `<span class="attr">translateY</span>($&#123;<span class="attr">translateY</span>&#125;)` &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&#123;outerRef&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&quot;scrollbar-outer&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onScroll</span>=<span class="string">&#123;handleScroll&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-inner&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;innerRef&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="隐藏真实滚动条"><a href="#隐藏真实滚动条" class="headerlink" title="隐藏真实滚动条"></a>隐藏真实滚动条</h2><p>至此模拟垂直滚动条的功能已经全部实现了，但是之前为了观察模拟滚动条的效果，还一直保留有真实滚动条，所以我们要隐藏真实滚动条，滚动条的宽度在各个系统中有差异，所以还需要一个辅助函数计算当前系统滚动条的宽度。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">getScrollBarWidth</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> outer = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">  outer.<span class="property">style</span>.<span class="property">visibility</span> = <span class="string">&#x27;hidden&#x27;</span>;</span><br><span class="line">  outer.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;100px&#x27;</span>;</span><br><span class="line">  outer.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&#x27;absolute&#x27;</span>;</span><br><span class="line">  outer.<span class="property">style</span>.<span class="property">top</span> = <span class="string">&#x27;-9999px&#x27;</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(outer);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> widthNoScroll = outer.<span class="property">offsetWidth</span>;</span><br><span class="line">  outer.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&#x27;scroll&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> inner = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">  inner.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;100%&#x27;</span>;</span><br><span class="line">  outer.<span class="title function_">appendChild</span>(inner);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> widthWithScroll = inner.<span class="property">offsetWidth</span>;</span><br><span class="line">  outer.<span class="property">parentNode</span>.<span class="title function_">removeChild</span>(outer);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> widthNoScroll - widthWithScroll;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>计算滚动条宽度的代码原理也很简单，通过向浏览器插入一个真实滚动的容器来计算滚动条的宽度，有了滚动条宽度之后，可以通过将滚动容器的marginRight设置为负值，来达到隐藏垂直滚动条的目的，代码如下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Scrollbar</span> = (<span class="params">&#123;children, height&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 其他代码省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 是否需要显示垂直滚动条</span></span><br><span class="line">  <span class="keyword">const</span> [shouldShowVerticval, setShouldShowVerticval] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> [marginX, setMarginX] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> scrollBarWidth = <span class="title function_">useRef</span>(<span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> inner = innerRef.<span class="property">current</span>;</span><br><span class="line">    <span class="keyword">if</span> (inner) &#123;</span><br><span class="line">      <span class="keyword">if</span> (height === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="title function_">setShouldShowVerticval</span>(<span class="literal">false</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (inner.<span class="property">clientHeight</span> &lt;= height) &#123;</span><br><span class="line">        <span class="title function_">setShouldShowVerticval</span>(<span class="literal">false</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">setShouldShowVerticval</span>(<span class="literal">true</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [innerRef.<span class="property">current</span>, height]);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    scrollBarWidth.<span class="property">current</span> = <span class="title function_">getScrollBarWidth</span>();</span><br><span class="line">    <span class="title function_">setMarginX</span>(scrollBarWidth.<span class="property">current</span>);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 其他代码省略</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-container&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;height&#125;&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        shouldShowVerticval &amp;&amp; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-vertical-track&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleVerticalTrackMouseDown&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;vertical-thumb&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleVerticalThumbMouseDown&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">scrollHeight</span>, <span class="attr">transform:</span> `<span class="attr">translateY</span>($&#123;<span class="attr">translateY</span>&#125;)` &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        )</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&#123;outerRef&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&quot;scrollbar-outer&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onScroll</span>=<span class="string">&#123;handleScroll&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginRight:</span> <span class="attr">shouldShowVerticval</span> ? `<span class="attr">-</span>$&#123;<span class="attr">marginX</span>&#125;<span class="attr">px</span>` <span class="attr">:</span> <span class="attr">0</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-inner&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;innerRef&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="水平滚动条"><a href="#水平滚动条" class="headerlink" title="水平滚动条"></a>水平滚动条</h2><p>水平滚动条的原理和垂直滚动条的原理基本一致，只是把在Y轴上的计算换成X轴，首先添加模拟的滚动条元素和样式：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Scrollbar</span> = (<span class="params">&#123;children, height, width&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 其他代码省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> scaleX = <span class="title function_">useRef</span>(<span class="number">0</span>); <span class="comment">// 存储比例，供后面使用</span></span><br><span class="line">  <span class="keyword">const</span> [translateX, setTranslateX] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> [scrollWidth, setScrollWidth] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 其他代码省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-container&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;height,</span> <span class="attr">width</span>&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        shouldShowVerticval &amp;&amp; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-vertical-track&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleVerticalTrackMouseDown&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;vertical-thumb&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleVerticalThumbMouseDown&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">scrollHeight</span>, <span class="attr">transform:</span> `<span class="attr">translateY</span>($&#123;<span class="attr">translateY</span>&#125;)` &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        )</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-horizontal-track&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleHorizontalTrackMouseDown&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;horizontal-thumb&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleHorizontalThumbMouseDown&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">scrollWidth</span>, <span class="attr">transform:</span> `<span class="attr">translateX</span>($&#123;<span class="attr">translateX</span>&#125;)` &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      </span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&#123;outerRef&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&quot;scrollbar-outer&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onScroll</span>=<span class="string">&#123;handleScroll&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginRight:</span> <span class="attr">shouldShowVerticval</span> ? `<span class="attr">-</span>$&#123;<span class="attr">marginX</span>&#125;<span class="attr">px</span>` <span class="attr">:</span> <span class="attr">0</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-inner&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;innerRef&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>水平滚动条样式代码如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.scrollbar-container</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.scrollbar-horizontal-track</span>  &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.scrollbar-horizontal-track</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ff9d0036</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">0.25s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.horizontal-thumb</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">background</span>: gray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面的分别计算滑块的位置，和相应的事件，完整代码如下：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Scrollbar</span> = (<span class="params">&#123;children, height, width&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> outerRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> innerRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> outerRect = <span class="title function_">useRef</span>(&#123; <span class="attr">height</span>: <span class="number">0</span>, <span class="attr">width</span>: <span class="number">0</span> &#125;);</span><br><span class="line">  <span class="keyword">const</span> innerRect = <span class="title function_">useRef</span>(&#123; <span class="attr">height</span>: <span class="number">0</span>, <span class="attr">width</span>: <span class="number">0</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> scaleY = <span class="title function_">useRef</span>(<span class="number">0</span>); <span class="comment">// 存储比例，供后面使用</span></span><br><span class="line">  <span class="keyword">const</span> [translateY, setTranslateY] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [scrollHeight, setScrollHeight] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断是否按下鼠标</span></span><br><span class="line">  <span class="keyword">const</span> verticalMouseDown = <span class="title function_">useRef</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="comment">// 记录按下鼠标时指针的位置</span></span><br><span class="line">  <span class="keyword">const</span> startY = <span class="title function_">useRef</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 记录按下鼠标时，已经滚动的距离</span></span><br><span class="line">  <span class="keyword">const</span> startScrollTop = <span class="title function_">useRef</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 是否需要显示垂直滚动条</span></span><br><span class="line">  <span class="keyword">const</span> [shouldShowVerticval, setShouldShowVerticval] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> [marginX, setMarginX] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> scrollBarWidth = <span class="title function_">useRef</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> scaleX = <span class="title function_">useRef</span>(<span class="number">0</span>); </span><br><span class="line">  <span class="keyword">const</span> [translateX, setTranslateX] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> [scrollWidth, setScrollWidth] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> horizontalMouseDown = <span class="title function_">useRef</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> startX = <span class="title function_">useRef</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> startScrollLeft = <span class="title function_">useRef</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> [shouldShowHorizontal, setShouldShowHorizontal] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleScroll</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 2. 滚动时计算滑块的位置</span></span><br><span class="line">    <span class="keyword">const</span> &#123;height&#125; = outerRect.<span class="property">current</span>;</span><br><span class="line">    <span class="comment">// 通过百分比的计算方式最为简单</span></span><br><span class="line">    <span class="keyword">const</span> y = e.<span class="property">currentTarget</span>.<span class="property">scrollTop</span> / height * <span class="number">100</span> + <span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">    <span class="title function_">setTranslateY</span>(y);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> x = e.<span class="property">currentTarget</span>.<span class="property">scrollLeft</span> / width * <span class="number">100</span> + <span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">    <span class="title function_">setTranslateX</span>(x);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. 滑轨点击事件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleVerticalTrackMouseDown</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">height</span>: outerH &#125; = outerRect.<span class="property">current</span>;</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">height</span>: innerH &#125; = innerRect.<span class="property">current</span>;</span><br><span class="line">    <span class="comment">// 获取点击时，在滚动条上的位置</span></span><br><span class="line">    <span class="keyword">const</span> offset = e.<span class="property">clientY</span> - e.<span class="property">currentTarget</span>.<span class="title function_">getBoundingClientRect</span>().<span class="property">top</span>;</span><br><span class="line">    <span class="keyword">const</span> scrollTop = offset / outerH * innerH - outerH / <span class="number">2</span>;</span><br><span class="line">    outerRef.<span class="property">current</span>.<span class="property">scrollTop</span> = scrollTop;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4.滑块拖拽事件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleVerticalThumbMouseDown</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 阻止默认行为, 防止选中文本</span></span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="comment">// 阻止事件冒泡, 防止触发滑轨点击事件</span></span><br><span class="line">    e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">    verticalMouseDown.<span class="property">current</span> = <span class="literal">true</span>;</span><br><span class="line">    startY.<span class="property">current</span> = e.<span class="property">clientY</span>;</span><br><span class="line">    startScrollTop.<span class="property">current</span> = outerRef.<span class="property">current</span>.<span class="property">scrollTop</span>;</span><br><span class="line">    <span class="comment">// 在window上增加move事件，鼠标移动出滑轨的区域仍然有效</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, handleMouseMove);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, handleMouseUp);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleHorizontalTrackMouseDown</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">width</span>: outerW &#125; = outerRect.<span class="property">current</span>;</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">width</span>: innerW &#125; = innerRect.<span class="property">current</span>;</span><br><span class="line">    <span class="keyword">const</span> offset = e.<span class="property">clientX</span> - e.<span class="property">currentTarget</span>.<span class="title function_">getBoundingClientRect</span>().<span class="property">left</span>;</span><br><span class="line">    <span class="keyword">const</span> scrollLeft = offset / outerW * innerW - outerW / <span class="number">2</span>;</span><br><span class="line">    outerRef.<span class="property">current</span>.<span class="property">scrollLeft</span> = scrollLeft;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleHorizontalThumbMouseDown</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 阻止默认行为, 防止选中文本</span></span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="comment">// 阻止事件冒泡, 防止触发滑轨点击事件</span></span><br><span class="line">    e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">    horizontalMouseDown.<span class="property">current</span> = <span class="literal">true</span>;</span><br><span class="line">    startX.<span class="property">current</span> = e.<span class="property">clientX</span>;</span><br><span class="line">    startScrollLeft.<span class="property">current</span> = outerRef.<span class="property">current</span>.<span class="property">scrollLeft</span>;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, handleMouseMove);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, handleMouseUp);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleMouseMove</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 阻止默认行为, 防止选中文本</span></span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="keyword">if</span> (verticalMouseDown.<span class="property">current</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> offsetY = e.<span class="property">clientY</span> - startY.<span class="property">current</span>;</span><br><span class="line">      outerRef.<span class="property">current</span>.<span class="property">scrollTop</span> = startScrollTop.<span class="property">current</span> + offsetY * scaleY.<span class="property">current</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleMouseUp</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (verticalMouseDown.<span class="property">current</span>) &#123;</span><br><span class="line">      verticalMouseDown.<span class="property">current</span> = <span class="literal">false</span>;</span><br><span class="line">      startY.<span class="property">current</span> = <span class="number">0</span>;</span><br><span class="line">      <span class="comment">// 结束后移除事件监听，防止其他bug产生</span></span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, handleMouseMove);</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, handleMouseUp);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 1. 计算垂直滑块的高度</span></span><br><span class="line">    <span class="keyword">const</span> outer = outerRef.<span class="property">current</span>;</span><br><span class="line">    <span class="keyword">const</span> inner = innerRef.<span class="property">current</span>;</span><br><span class="line">    <span class="keyword">if</span> (outer &amp;&amp; inner) &#123;</span><br><span class="line">        outerRect.<span class="property">current</span> = &#123; <span class="attr">height</span>: outer.<span class="property">clientHeight</span>, <span class="attr">width</span>: outer.<span class="property">clientWidth</span> &#125;;</span><br><span class="line">        innerRect.<span class="property">current</span> = &#123; <span class="attr">height</span>: inner.<span class="property">clientHeight</span>, <span class="attr">width</span>: inner.<span class="property">clientWidth</span> &#125;;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 使用百分比计算滚动条的宽度和高度</span></span><br><span class="line">      <span class="title function_">setScrollHeight</span>(outer.<span class="property">clientHeight</span> / inner.<span class="property">clientHeight</span> * <span class="number">100</span> + <span class="string">&#x27;%&#x27;</span>);</span><br><span class="line">      <span class="keyword">const</span> thumbHeight = outer.<span class="property">clientHeight</span> / inner.<span class="property">clientHeight</span> * outer.<span class="property">clientHeight</span>;</span><br><span class="line">      scaleY.<span class="property">current</span> = (innerRect.<span class="property">current</span>.<span class="property">height</span> - outerRect.<span class="property">current</span>.<span class="property">height</span>) / (outerRect.<span class="property">current</span>.<span class="property">height</span> - thumbHeight);</span><br><span class="line"></span><br><span class="line">      <span class="title function_">setScrollWidth</span>(outer.<span class="property">clientWidth</span> / inner.<span class="property">clientWidth</span> * <span class="number">100</span> + <span class="string">&#x27;%&#x27;</span>);</span><br><span class="line">      <span class="keyword">const</span> thumbWidth = outer.<span class="property">clientWidth</span> / inner.<span class="property">clientWidth</span> * outer.<span class="property">clientWidth</span>;</span><br><span class="line">      scaleX.<span class="property">current</span> = (innerRect.<span class="property">current</span>.<span class="property">width</span> - outerRect.<span class="property">current</span>.<span class="property">width</span>) / (outerRect.<span class="property">current</span>.<span class="property">width</span> - thumbWidth);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [outerRef.<span class="property">current</span>, innerRef.<span class="property">current</span>]);</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> inner = innerRef.<span class="property">current</span>;</span><br><span class="line">    <span class="keyword">if</span> (inner) &#123;</span><br><span class="line">      <span class="keyword">if</span> (height === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="title function_">setShouldShowVerticval</span>(<span class="literal">false</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (inner.<span class="property">clientHeight</span> &lt;= height) &#123;</span><br><span class="line">        <span class="title function_">setShouldShowVerticval</span>(<span class="literal">false</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">setShouldShowVerticval</span>(<span class="literal">true</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (width === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="title function_">setShouldShowHorizontal</span>(<span class="literal">false</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (inner.<span class="property">clientWidth</span> &lt;= width) &#123;</span><br><span class="line">        <span class="title function_">setShouldShowHorizontal</span>(<span class="literal">false</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">setShouldShowHorizontal</span>(<span class="literal">true</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [innerRef.<span class="property">current</span>, height]);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    scrollBarWidth.<span class="property">current</span> = <span class="title function_">getScrollBarWidth</span>();</span><br><span class="line">    <span class="title function_">setMarginX</span>(scrollBarWidth.<span class="property">current</span>);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-container&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;height,</span> <span class="attr">width</span>&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        shouldShowVerticval &amp;&amp; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-vertical-track&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleVerticalTrackMouseDown&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;vertical-thumb&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleVerticalThumbMouseDown&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">scrollHeight</span>, <span class="attr">transform:</span> `<span class="attr">translateY</span>($&#123;<span class="attr">translateY</span>&#125;)` &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        )</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        shouldShowHorizontal &amp;&amp; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-horizontal-track&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleHorizontalTrackMouseDown&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;horizontal-thumb&quot;</span> <span class="attr">onMouseDown</span>=<span class="string">&#123;handleHorizontalThumbMouseDown&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">scrollWidth</span>, <span class="attr">transform:</span> `<span class="attr">translateX</span>($&#123;<span class="attr">translateX</span>&#125;)` &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        )</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">      </span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&#123;outerRef&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&quot;scrollbar-outer&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onScroll</span>=<span class="string">&#123;handleScroll&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">style</span>=<span class="string">&#123;&#123;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">marginRight:</span> <span class="attr">shouldShowVerticval</span> ? `<span class="attr">-</span>$&#123;<span class="attr">marginX</span>&#125;<span class="attr">px</span>` <span class="attr">:</span> <span class="attr">0</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">height:</span> <span class="attr">shouldShowHorizontal</span> ? `$&#123;<span class="attr">height</span> + <span class="attr">marginX</span>&#125;<span class="attr">px</span>` <span class="attr">:</span> <span class="attr">height</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;scrollbar-inner&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;innerRef&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>水平滚动条实现方式和垂直滚动条的方式几乎一致，唯一不同的是隐藏水平滚动条的方式，隐藏水平滚动条需要设置容器的高度。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以上就是实现模拟滚动条的全部代码，用到的事件只有mouseDown、mouseMove、mouseUp和scroll等事件，通过这些事件来模拟滚动条的拖拽和点击事件。通过这种方式，我们可以自定义滚动条的样式，实现更加灵活的滚动条效果。不过上面的代码还不支持阿拉伯语的右对齐样式，如果需要支持阿拉伯语，还需要对滑块的位置进行调整。但对于不需要考虑阿拉伯语的项目，上面的代码已经足够了。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://joyran.github.io/yi-blog/blog/scrollbar.html">https://joyran.github.io/yi-blog/blog/scrollbar.html</a></li>
</ul>


                

                <ul class="pager">
                    
                        <li class="previous"><a href="/翻译/从零实现一个简单的test-runner.html">&larr;  上一篇</a></li>
                    
                    
                        <li class="next"><a href="/学习/从零实现一个简易模块打包器.html">下一篇 &rarr;</a></li>
                    
                </ul>
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>


    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/neilning-xc" rel="external nofollow noreferrer" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li>
                            <a href="mailto:ningcoder@foxmail.com" rel="external nofollow noreferrer" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2025 Neil Ning<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/" rel="external nofollow noreferrer">Clean Blog</a> from <a href="http://startbootstrap.com/" rel="external nofollow noreferrer" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/" rel="external nofollow noreferrer">Hexo</a> by <a href="http://www.codeblocq.com/" rel="external nofollow noreferrer" target="_blank">Jonathan Klughertz</a></p>
                <!-- <p class="copyright text-muted"><a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.miitbeian.gov.cn/">豫ICP备19003046号</a></p> -->
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//lib.baomitu.com/jquery/2.1.4/jquery.min.js"></script>

<!-- Bootstrap -->
<script src="//lib.baomitu.com/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//lib.baomitu.com/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>