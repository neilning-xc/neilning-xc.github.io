<!DOCTYPE html>
<html lang="zh-CN">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="Tell the world with code"/>
    

    <!--Author-->
    
        <meta name="author" content="Neil Ning"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="å¸¸è§åŠ å¯†ç®—æ³•åŠå…¶ä½¿ç”¨"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Tell the world with code"/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="Neilçš„åšå®¢"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="https://neilning-xc.github.io/img/banner.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="https://neilning-xc.github.io/img/banner.jpg"/>
    

    <!-- Title -->
    
    <title>å¸¸è§åŠ å¯†ç®—æ³•åŠå…¶ä½¿ç”¨ - Neilçš„åšå®¢</title>

    <!-- Bootstrap Core CSS -->
    <link href="//lib.baomitu.com/twitter-bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//lib.baomitu.com/featherlight/1.3.5/featherlight.min.css" rel="stylesheet"/>

    <!-- Google Analytics -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPEMLKFYYW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ZPEMLKFYYW');
    </script>



    <!-- favicon -->
    

<meta name="generator" content="Hexo 5.4.2"></head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Neilçš„åšå®¢</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                é¦–é¡µ
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                å½’æ¡£
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                æ ‡ç­¾
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                åˆ†ç±»
                            
                        </a>
                    </li>
                
                    <li>
                        <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/neilning-xc/neilning-xc.github.io">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header post-header" style="background-image: url('å¸¸è§åŠ å¯†ç®—æ³•åŠå…¶ä½¿ç”¨/bg.jpeg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>å¸¸è§åŠ å¯†ç®—æ³•åŠå…¶ä½¿ç”¨</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                            Posted by Neil Ning on
                        
                        
                            2024-12-09
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/MD5/">#MD5</a> <a href="/tags/SHA/">#SHA</a> <a href="/tags/RSA/">#RSA</a> <a href="/tags/AES/">#AES</a> <a href="/tags/DES/">#DES</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                        

<a href="/categories/å­¦ä¹ /">å­¦ä¹ </a>

                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h1 id="å¸¸è§å“ˆå¸Œã€ç­¾åå’ŒåŠ å¯†ç®—æ³•"><a href="#å¸¸è§å“ˆå¸Œã€ç­¾åå’ŒåŠ å¯†ç®—æ³•" class="headerlink" title="å¸¸è§å“ˆå¸Œã€ç­¾åå’ŒåŠ å¯†ç®—æ³•"></a>å¸¸è§å“ˆå¸Œã€ç­¾åå’ŒåŠ å¯†ç®—æ³•</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨æ—¥å¸¸çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æˆ–å¤šæˆ–å°‘éƒ½è§è¿‡æˆ–è€…å¬è¿‡ä¸€äº›å…³äºè®¡ç®—å“ˆå¸Œï¼Œç­¾åå’ŒåŠ å¯†çš„ç®—æ³•ã€‚è¿™äº›ç®—æ³•åœ¨è®¡ç®—æœºé¢†åŸŸä¸­æœ‰ç€éå¸¸é‡è¦çš„åœ°ä½ï¼Œä¸åŒçš„ç®—æ³•ä¹Ÿéƒ½æœ‰ä¸åŒçš„è‹±æ–‡åç§°ï¼Œæ¯”å¦‚MD5ã€SHA-1ã€RSAã€AESç­‰ç­‰ã€‚æ¯æ¬¡çœ‹åˆ°è¿™äº›ç®—æ³•éƒ½ä¼šæœ‰ä¸€ç§ä¼¼æ›¾ç›¸è¯†çš„æ„Ÿè§‰ï¼Œä½†æ˜¯å…·ä½“å±äºå“ªä¸€ç±»ç®—æ³•ï¼Œåˆæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Œå´å¾ˆéš¾è¯´æ¸…æ¥šã€‚æœ¬æ–‡å°†å¯¹è¿™äº›å¸¸è§çš„ç®—æ³•è¿›è¡Œä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼Œå¸Œæœ›èƒ½å¤Ÿç†æ¸…è¿™äº›ç®—æ³•ä¹‹é—´çš„å…³ç³»ã€‚æ–‡ä¸­ä¹Ÿä¼šä½¿ç”¨Nodejsçš„cryptoæ¨¡å—æ¥æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨è¿™äº›ç®—æ³•ã€‚</p>
<h2 id="å“ˆå¸Œç®—æ³•"><a href="#å“ˆå¸Œç®—æ³•" class="headerlink" title="å“ˆå¸Œç®—æ³•"></a>å“ˆå¸Œç®—æ³•</h2><p>é¦–å…ˆä»æœ€å®¹æ˜“ç†è§£çš„å“ˆå¸Œç®—æ³•å¼€å§‹ã€‚<strong>å“ˆå¸Œç®—æ³•æ˜¯ä¸€ç§å°†ä»»æ„é•¿åº¦çš„è¾“å…¥æ•°æ®è½¬æ¢ä¸ºå›ºå®šé•¿åº¦çš„è¾“å‡ºæ•°æ®çš„ç®—æ³•ã€‚</strong>å®ƒçš„ç‰¹ç‚¹æ˜¯ä¸åŒçš„è¾“å…¥ä¼šå¾—åˆ°ä¸åŒçš„è¾“å‡ºï¼Œç›¸åŒçš„è¾“å…¥ï¼Œä¼šå¾—åˆ°ç›¸åŒçš„è¾“å‡ºï¼Œå¹¶ä¸”è¾“å‡ºæ˜¯ä¸å¯é€†çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå“ˆå¸Œç®—æ³•æ˜¯ä¸€ç§å•å‘çš„ç®—æ³•ï¼Œåªèƒ½ä»è¾“å…¥å¾—åˆ°è¾“å‡ºï¼Œä¸èƒ½ä»è¾“å‡ºå¾—åˆ°è¾“å…¥ã€‚</p>
<p>å“ˆå¸Œç®—æ³•æœ€å¸¸è§çš„æ˜¯åº”ç”¨åœ¨æ–‡ä»¶ä¼ è¾“ä¸­ï¼Œå¯ä»¥å¯¹ä»»æ„é•¿åº¦çš„æ–‡ä»¶æ•°æ®è®¡ç®—å“ˆå¸Œå€¼ï¼Œä»¥éªŒè¯æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚å¸¸è§çš„å“ˆå¸Œç®—æ³•æœ‰MD5ã€SHA-1ã€SHA-256ç­‰ç­‰ã€‚ä¸åŒçš„ç®—æ³•å¾—åˆ°çš„å“ˆå¸Œå€¼é•¿åº¦ä¸åŒï¼Œæ¯”å¦‚MD5çš„å“ˆå¸Œå€¼é•¿åº¦æ˜¯128ä½ï¼ŒSHA-1çš„å“ˆå¸Œå€¼é•¿åº¦æ˜¯160ä½ã€‚å“ˆå¸Œç®—æ³•çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> password = <span class="string">&#x27;qwertyuiop&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> md5 = crypto.<span class="title function_">createHash</span>(<span class="string">&#x27;md5&#x27;</span>);</span><br><span class="line">md5.<span class="title function_">update</span>(password);</span><br><span class="line"><span class="keyword">const</span> encryptedPassword = md5.<span class="title function_">digest</span>(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(encryptedPassword);  <span class="comment">// 6eea9b7ef19179a06954edd0f6c05ceb</span></span><br></pre></td></tr></table></figure>

<p>updateæ–¹æ³•ç”¨äºè¾“å…¥æ•°æ®ï¼Œé™¤äº†å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯Bufferã€TypedArrayã€DataViewç­‰æ•°æ®ç±»å‹ã€‚digestæ–¹æ³•ç”¨äºè¾“å‡ºå“ˆå¸Œå€¼ï¼Œå‚æ•°å¯ä»¥æ˜¯<code>hex</code>ã€<code>base64</code>ã€<code>latin1</code>ç­‰ï¼Œè¡¨ç¤ºè¾“å‡ºçš„ç¼–ç æ ¼å¼ã€‚å¸¸è§çš„è¾“å‡ºæ ¼å¼æ˜¯hexï¼Œå³16è¿›åˆ¶ç¼–ç ã€‚</p>
<p>è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–çš„å“ˆå¸Œç®—æ³•ï¼Œæ¯”å¦‚SHA-1ã€SHA-256ç­‰ï¼Œåªéœ€è¦å°†<code>createHash</code>æ–¹æ³•çš„å‚æ•°æ”¹ä¸ºå¯¹åº”çš„ç®—æ³•åç§°å³å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> password = <span class="string">&#x27;qwertyuiop&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> sha = crypto.<span class="title function_">createHash</span>(<span class="string">&#x27;sha256&#x27;</span>);</span><br><span class="line">sha.<span class="title function_">update</span>(password);</span><br><span class="line"><span class="keyword">const</span> encryptedPassword = sha.<span class="title function_">digest</span>(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(encryptedPassword); <span class="comment">// 9a900403ac313ba27a1bc81f0932652b8020dac92c234d98fa0b06bf0040ecfd</span></span><br></pre></td></tr></table></figure>
<p>é‚£å¦‚ä½•å¯¹æ–‡ä»¶è¿›è¡Œå“ˆå¸Œè®¡ç®—å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨Nodejsçš„fsæ¨¡å—æ¥è¯»å–æ–‡ä»¶æ•°æ®ï¼Œç„¶åè®¡ç®—å“ˆå¸Œå€¼ã€‚ç”±äºæ–‡ä»¶æ•°æ®å¯èƒ½æ¯”è¾ƒå¤§ï¼Œä¸é€‚åˆä¸€æ¬¡æ€§è¯»å–ï¼Œå¯ä»¥ä½¿ç”¨æµçš„æ–¹å¼æ¥è¯»å–æ–‡ä»¶æ•°æ®ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hash = crypto.<span class="title function_">createHash</span>(<span class="string">&#x27;md5&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> stream = fs.<span class="title function_">createReadStream</span>(<span class="string">&#x27;test.png&#x27;</span>);</span><br><span class="line"></span><br><span class="line">stream.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  hash.<span class="title function_">update</span>(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">stream.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(hash.<span class="title function_">digest</span>(<span class="string">&#x27;hex&#x27;</span>)); <span class="comment">// a1fe07317fe10f97cfb2e2a9e65cb46f</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…é€šè¿‡ä¸‹é¢çš„æ–¹å¼æ¥ç®€åŒ–ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hash = crypto.<span class="title function_">createHash</span>(<span class="string">&#x27;md5&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> stream = fs.<span class="title function_">createReadStream</span>(<span class="string">&#x27;test.png&#x27;</span>);</span><br><span class="line"></span><br><span class="line">stream.<span class="title function_">on</span>(<span class="string">&#x27;readable&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> data = stream.<span class="title function_">read</span>();</span><br><span class="line">  <span class="keyword">if</span> (data) &#123;</span><br><span class="line">    hash.<span class="title function_">update</span>(data);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(hash.<span class="title function_">digest</span>(<span class="string">&#x27;hex&#x27;</span>)); <span class="comment">// a1fe07317fe10f97cfb2e2a9e65cb46f</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…è¿˜å¯ä»¥ä½¿ç”¨<code>pipe</code>æ–¹æ³•æ¥å®ç°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Writable</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;stream&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hash = crypto.<span class="title function_">createHash</span>(<span class="string">&#x27;md5&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> stream = fs.<span class="title function_">createReadStream</span>(<span class="string">&#x27;test.png&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> writable = <span class="keyword">new</span> <span class="title class_">Writable</span>(&#123;</span><br><span class="line">  <span class="title function_">write</span>(<span class="params">chunk, encoding, callback</span>) &#123;</span><br><span class="line">    hash.<span class="title function_">update</span>(chunk);</span><br><span class="line">    <span class="title function_">callback</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">final</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(hash.<span class="title function_">digest</span>(<span class="string">&#x27;hex&#x27;</span>)); <span class="comment">// a1fe07317fe10f97cfb2e2a9e65cb46f</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">stream.<span class="title function_">pipe</span>(hash).<span class="title function_">pipe</span>(writable);</span><br></pre></td></tr></table></figure>

<h2 id="hmacç®—æ³•"><a href="#hmacç®—æ³•" class="headerlink" title="hmacç®—æ³•"></a>hmacç®—æ³•</h2><p>ä¸Šé¢çš„hashç®—æ³•æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œä¸èƒ½ç”¨äºéªŒè¯æ•°æ®çš„æ¥æºã€‚å¦‚æœä½¿ç”¨hashç®—æ³•æ¥å­˜å‚¨å¯†ç ï¼Œä¼šæœ‰hashç¢°æ’çš„é—®é¢˜ã€‚é»‘å®¢å¯ä»¥ä½¿ç”¨å½©è™¹è¡¨æ¥ç ´è§£å¯†ç ã€‚å½©è™¹è¡¨æ˜¯ä¸€ç§é¢„å…ˆè®¡ç®—å¥½çš„hashå€¼å’Œæ˜æ–‡çš„å¯¹åº”å…³ç³»è¡¨ã€‚é»‘å®¢å¯ä»¥é€šè¿‡hashå€¼æŸ¥æ‰¾å¯¹åº”çš„æ˜æ–‡ï¼Œä»è€Œç ´è§£å¯†ç ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨hmacç®—æ³•ã€‚<strong>hmacç®—æ³•æ˜¯ä¸€ç§å¸¦æœ‰å¯†é’¥çš„å“ˆå¸Œç®—æ³•ï¼Œå¯ä»¥ç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§å’Œæ¥æºã€‚</strong>å¯ä»¥çœ‹ä½œæ˜¯ä¸Šé¢çš„md5ç®—æ³•çš„å¢å¼ºç‰ˆï¼Œhmacç®—æ³•çš„å…¨ç§°æ˜¯Hash-based Message Authentication Codeï¼Œå®ƒçš„è®¡ç®—æ–¹å¼æ˜¯å°†å¯†é’¥å’Œæ•°æ®è¿›è¡Œæ··åˆï¼Œç„¶åå†è®¡ç®—å“ˆå¸Œå€¼ã€‚è¿™æ ·ï¼Œå³ä½¿æ•°æ®æ³„éœ²ï¼Œé»‘å®¢ä¹Ÿæ— æ³•ä¼ªé€ æ•°æ®ï¼Œå› ä¸ºé»‘å®¢ä¸çŸ¥é“å¯†é’¥ã€‚ä»–çš„ä½¿ç”¨æ–¹å¼å’Œhashç®—æ³•ç±»ä¼¼ï¼Œåªæ˜¯éœ€è¦ä¼ å…¥å¯†é’¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> secret = <span class="string">&#x27;abcdefg&#x27;</span>; <span class="comment">// å¯†é’¥</span></span><br><span class="line"><span class="keyword">const</span> password = <span class="string">&#x27;qwertyuiop&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> hash = crypto.<span class="title function_">createHmac</span>(<span class="string">&#x27;sha256&#x27;</span>, secret);</span><br><span class="line">hash.<span class="title function_">update</span>(password);</span><br><span class="line"><span class="keyword">const</span> encryptedPassword = hash.<span class="title function_">digest</span>(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(encryptedPassword); <span class="comment">// 566f3cdadb9e1f4543e0ad030c1996fccb68e530356e4563c75c20a470fb23d1</span></span><br></pre></td></tr></table></figure>

<p>åªè¦å¯†é’¥ä¸åŒï¼Œå³ä½¿ç›¸åŒçš„æ•°æ®ï¼Œä¹Ÿä¼šå¾—åˆ°ä¸åŒçš„å“ˆå¸Œå€¼ã€‚è¿™æ ·å°±å¯ä»¥é¿å…hashç¢°æ’çš„é—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> secret = crypto.<span class="title function_">randomBytes</span>(<span class="number">16</span>).<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>); <span class="comment">// å¯†é’¥</span></span><br><span class="line">  <span class="keyword">const</span> password = <span class="string">&#x27;qwertyuiop&#x27;</span>;</span><br><span class="line">  <span class="keyword">const</span> hash = crypto.<span class="title function_">createHmac</span>(<span class="string">&#x27;sha1&#x27;</span>, secret);</span><br><span class="line">  hash.<span class="title function_">update</span>(password);</span><br><span class="line">  <span class="keyword">const</span> encryptedPassword = hash.<span class="title function_">digest</span>(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(encryptedPassword);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤§æ–‡ä»¶æµçš„ä½¿ç”¨æ–¹å¼å’Œhashç®—æ³•ç±»ä¼¼ï¼Œåªæ˜¯éœ€è¦ä¼ å…¥å¯†é’¥ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p>
<h2 id="å¯¹ç§°åŠ å¯†ç®—æ³•"><a href="#å¯¹ç§°åŠ å¯†ç®—æ³•" class="headerlink" title="å¯¹ç§°åŠ å¯†ç®—æ³•"></a>å¯¹ç§°åŠ å¯†ç®—æ³•</h2><p>åŠ å¯†ç®—æ³•å’Œä¸Šé¢çš„å“ˆå¸Œç®—æ³•å’Œhmacç®—æ³•ä¸åŒï¼Œå®ƒæ˜¯ä¸€ç§åŒå‘çš„ç®—æ³•ï¼Œå¯ä»¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚<strong>å¯¹ç§°åŠ å¯†æŒ‡çš„æ˜¯åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒå¯†é’¥çš„ç®—æ³•ã€‚</strong>å¸¸è§çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰DESã€3DESã€AESç­‰ã€‚</p>
<p>cryptoæ¨¡å—ä½¿ç”¨<code>createCipheriv</code>æ–¹æ³•æ¥åˆ›å»ºåŠ å¯†å¯¹è±¡ï¼Œä½¿ç”¨<code>createDecipheriv</code>æ–¹æ³•æ¥åˆ›å»ºè§£å¯†å¯¹è±¡ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½éœ€è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯</p>
<ol>
<li>ç®—æ³•åç§°ï¼Œå¦‚<code>aes-128-cbc</code>ã€<code>aes-192-cbc</code>ã€<code>aes-256-cbc</code>ç­‰ï¼Œä¸­é—´çš„æ•°å­—è¡¨ç¤ºå¯†é’¥é•¿åº¦ï¼Œcbcè¡¨ç¤ºåŠ å¯†æ¨¡å¼ã€‚</li>
<li>å¯†é’¥ï¼Œé•¿åº¦å’Œç®—æ³•æœ‰å…³ï¼Œæ¯”å¦‚AESçš„å¯†é’¥é•¿åº¦å¯ä»¥æ˜¯128ä½ã€192ä½ã€256ä½ã€‚</li>
<li>åˆå§‹åŒ–å‘é‡ivã€‚å¯ä»¥æ˜¯ä¸€ä¸ªéšæœºæ•°ï¼Œç”¨äºå¢åŠ åŠ å¯†å¼ºåº¦ã€‚ivçš„é•¿åº¦å’Œç®—æ³•æœ‰å…³ï¼Œæ¯”å¦‚AESçš„ivé•¿åº¦æ˜¯16å­—èŠ‚ï¼ˆ128ä½ï¼‰ï¼ŒDESçš„ivé•¿åº¦æ˜¯8å­—èŠ‚ã€‚ï¼ˆ64ä½ï¼‰</li>
</ol>
<p>åŠ å¯†å’Œè§£å¯†è¿˜éœ€è¦è°ƒç”¨<code>update</code>æ–¹æ³•å’Œ<code>final</code>æ–¹æ³•ï¼Œ<code>update</code>æ–¹æ³•ç”¨äºè¾“å…¥æ•°æ®ï¼Œ<code>final</code>æ–¹æ³•ç”¨äºè¾“å‡ºæ•°æ®ã€‚<code>update</code>æ–¹æ³•ä¹Ÿéœ€è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯</p>
<ol>
<li>è¾“å…¥æ•°æ®</li>
<li>è¾“å…¥æ•°æ®çš„ç¼–ç æ ¼å¼ï¼Œå¯ä»¥æ˜¯<code>utf8</code>ã€<code>hex</code>ã€<code>base64</code>ç­‰</li>
<li>è¾“å‡ºæ•°æ®çš„ç¼–ç æ ¼å¼ï¼Œå¯ä»¥æ˜¯<code>hex</code>ã€<code>base64</code>ç­‰</li>
</ol>
<p><code>final</code>æ–¹æ³•åªéœ€è¦ä¼ å…¥è¾“å‡ºæ•°æ®çš„ç¼–ç æ ¼å¼å³å¯ã€‚</p>
<p>å¯¹ç§°åŠ å¯†çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">encrypt</span>(<span class="params">text, key, iv</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> cipher = crypto.<span class="title function_">createCipheriv</span>(<span class="string">&#x27;aes-128-cbc&#x27;</span>, key, iv);</span><br><span class="line">  <span class="keyword">let</span> encrypted = cipher.<span class="title function_">update</span>(text, <span class="string">&#x27;utf8&#x27;</span>, <span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">  encrypted += cipher.<span class="title function_">final</span>(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> encrypted;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">decrypt</span>(<span class="params">encrypted, key, iv</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> decipher = crypto.<span class="title function_">createDecipheriv</span>(<span class="string">&#x27;aes-128-cbc&#x27;</span>, key, iv);</span><br><span class="line">  <span class="keyword">let</span> decrypted = decipher.<span class="title function_">update</span>(encrypted, <span class="string">&#x27;hex&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line">  decrypted += decipher.<span class="title function_">final</span>(<span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> decrypted;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> password = <span class="string">&#x27;qwertyuiop&#x27;</span>; <span class="comment">// æ˜æ–‡å¯†ç </span></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&#x27;1234567890123456&#x27;</span>; <span class="comment">// å¯†é’¥ 128ä½</span></span><br><span class="line"><span class="keyword">const</span> iv = <span class="string">&#x27;1234567890123456&#x27;</span>; <span class="comment">// å‘é‡ 128ä½</span></span><br><span class="line"><span class="keyword">const</span> encrypted = <span class="title function_">encrypt</span>(password, key, iv); <span class="comment">// åŠ å¯†</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(encrypted); <span class="comment">// 949cb01e787c29f7fa519ab2c9b98791</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> decrypted = <span class="title function_">decrypt</span>(encrypted, key, iv); <span class="comment">// è§£å¯†</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(decrypted === password); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç ä¸­ï¼Œ<code>encrypt</code>æ–¹æ³•ç”¨äºåŠ å¯†æ•°æ®ï¼Œ<code>decrypt</code>æ–¹æ³•ç”¨äºè§£å¯†æ•°æ®ã€‚åŠ å¯†å’Œè§£å¯†éƒ½éœ€è¦ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å’Œå‘é‡ã€‚è¿™é‡Œçš„å¯†é’¥å’Œå‘é‡éƒ½æ˜¯å›ºå®šçš„ï¼Œå®é™…ä½¿ç”¨ä¸­ï¼Œå¯†é’¥å’Œå‘é‡åº”è¯¥æ˜¯éšæœºçš„ï¼Œå¯ä»¥ä½¿ç”¨<code>crypto.randomBytes</code>æ–¹æ³•ç”Ÿæˆã€‚</p>
<h2 id="éå¯¹ç§°åŠ å¯†ç®—æ³•"><a href="#éå¯¹ç§°åŠ å¯†ç®—æ³•" class="headerlink" title="éå¯¹ç§°åŠ å¯†ç®—æ³•"></a>éå¯¹ç§°åŠ å¯†ç®—æ³•</h2><p>ä¸Šé¢çš„å¯¹ç§°åŠ å¯†ç®—æ³•åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œè¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•å®‰å…¨åœ°ä¼ è¾“å¯†é’¥å‘¢ï¼Ÿå¦‚æœå¯†é’¥æ³„éœ²ï¼Œé‚£ä¹ˆåŠ å¯†å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚<strong>éå¯¹ç§°åŠ å¯†ç®—æ³•ä½¿ç”¨ä¸€å¯¹å¯†é’¥ï¼Œåˆ†åˆ«æ˜¯å…¬é’¥å’Œç§é’¥ï¼Œå¯ä»¥ç”¨å…¬é’¥åŠ å¯†æ•°æ®ï¼Œç§é’¥è§£å¯†æ•°æ®ã€‚æˆ–è€…ç§é’¥åŠ å¯†æ•°æ®ï¼Œå…¬é’¥è§£å¯†æ•°æ®</strong>ã€‚å…¬é’¥å¯ä»¥å…¬å¼€ï¼Œç§é’¥å¿…é¡»ä¿å¯†ã€‚å¸¸è§çš„éå¯¹ç§°åŠ å¯†ç®—æ³•æœ‰RSAã€DSAã€ECCç­‰ã€‚</p>
<p>ä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•æ—¶ï¼Œéœ€è¦å…ˆç”Ÿæˆä¸€å¯¹å¯†é’¥ï¼Œå¯ä»¥opensslå‘½ä»¤ç”Ÿæˆä¸€å¯¹å¯†é’¥æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨cryptoæ¨¡å—çš„<code>generateKeyPair</code>æ–¹æ³•ç”Ÿæˆä¸€å¯¹å¯†é’¥ã€‚ä¸‹é¢åˆ†åˆ«ä»‹ç»è¿™ä¸¤ç§æ–¹å¼ã€‚</p>
<p>é¦–å…ˆæ˜¯ä½¿ç”¨opensslå‘½ä»¤ç”Ÿæˆä¸€å¯¹å¯†é’¥æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ç”Ÿæˆä¸€å¯¹RSAå¯†é’¥æ–‡ä»¶ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out private.pem 1024 // ç”Ÿæˆç§é’¥æ–‡ä»¶</span><br><span class="line">openssl rsa -in private.pem -pubout -out public.pem // ç”Ÿæˆå…¬é’¥æ–‡ä»¶</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå‘½ä»¤ç”Ÿæˆäº†PEMæ ¼å¼çš„ç§é’¥å’Œå…¬é’¥æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> private.pem</span></span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICXgIBAAKBgQDBO4jlIDpmIniRxMByRpVoEaQXsNjE3CF4wvoa8rbj6yVhESZA</span><br><span class="line">kJMDv/Pgr5Ew9GUbASuT+9UEaSwnqUyatg24u5WnXNqMCsAGl657/sFw2yMvpXs5</span><br><span class="line">gE+P0X8aPLghdy76x/PM0RmhMdVKLjsFmWbTUGUvfBZbJur8bs8E+IEYlwIDAQAB</span><br><span class="line">AoGBAIDtRx6RjUV+NHIWE81reN5x/slrzoYy1gZsGVIHpa2WxF7qgVpM3DqBRagh</span><br><span class="line">nD9MoXUOJ9RaD7wcrEBePmVvmOEAvSv2ucu1UpgFGwIy6i4a6oDmugvDvom4yjLT</span><br><span class="line">l8C5+PEKZp4anXWnAyalqfgQIjJdNiPIbttbPD3dt4P2mRcxAkEA/WN4FtyVATQw</span><br><span class="line">Cq3lKv41OsebzuMaW8szykWbmXoQtSn/t4FJIlRf0orwngA3jTlMA4fIoFTr1SjD</span><br><span class="line">WSjYWlQkbwJBAMM5WjGCL7zMOVRsl2DCpbigf3CXao5G4+pNxWV917OUDZX9mNDs</span><br><span class="line">I7FmqgvfjuH4n9EIgjCT6tNTvfPsyBDpclkCQQCld8hbPY68a4UX5DksGzdNfD4+</span><br><span class="line">G0YCPa9DXrNexTyV4ahRAEdu+KRejEbXFxMv0QPXplsYgHxFBcqTtb2bNylXAkEA</span><br><span class="line">haqXHp7MoLAT8MIJQ68CWM9LcoO56YCQPLTTGxJ2xfXw92mTYDjOl4B7nXWMFxxs</span><br><span class="line">EGuK+EfO2LLVtFXDBhFQwQJAP/Y0GPDlYF5YfrkKjXaI7uWZ/KVnQcYaoaj/Pqrb</span><br><span class="line">4pZ3wTB0RBcdDZz8oJ5xksf4/tpetigQgJlmaS/+vRBQLg==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> public.pem</span></span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDBO4jlIDpmIniRxMByRpVoEaQX</span><br><span class="line">sNjE3CF4wvoa8rbj6yVhESZAkJMDv/Pgr5Ew9GUbASuT+9UEaSwnqUyatg24u5Wn</span><br><span class="line">XNqMCsAGl657/sFw2yMvpXs5gE+P0X8aPLghdy76x/PM0RmhMdVKLjsFmWbTUGUv</span><br><span class="line">fBZbJur8bs8E+IEYlwIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>
<p>å…¬é’¥æ–‡ä»¶å’Œç§é’¥æ–‡ä»¶éƒ½æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥è¯»å–ã€‚å…¶æ ¼å¼å¿…é¡»æ»¡è¶³ä¸€å®šçš„è§„èŒƒï¼Œä¸€èˆ¬éƒ½æœ‰<code>BEGIN XXX</code>å’Œ<code>END XXX</code>å¼€å¤´å’Œç»“å°¾ï¼Œä¸­é—´æ˜¯å¯†é’¥çš„å†…å®¹ã€‚å†…å®¹éƒ¨åˆ†æ¯è¡Œæ˜¯64ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨<code>\n</code>æ¢è¡Œã€‚ç¼–ç æ ¼å¼ä¸€èˆ¬æ˜¯base64ç¼–ç ã€‚</p>
<p>cryptoæ¨¡å—çš„éå¯¹ç§°åŠ å¯†ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PUBLIC_KEY</span> = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;public.pem&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PRIVATE_KEY</span> = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;private.pem&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> password = <span class="string">&#x27;qwertyuiop&#x27;</span>; <span class="comment">// æ˜æ–‡å¯†ç </span></span><br><span class="line"><span class="comment">// ä½¿ç”¨å…¬é’¥åŠ å¯†ã€ç§é’¥è§£å¯†</span></span><br><span class="line"><span class="keyword">const</span> encrypted = crypto.<span class="title function_">publicEncrypt</span>(<span class="variable constant_">PUBLIC_KEY</span>, <span class="title class_">Buffer</span>.<span class="title function_">from</span>(password));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(encrypted.<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>));</span><br><span class="line"><span class="keyword">const</span> decrypted = crypto.<span class="title function_">privateDecrypt</span>(<span class="variable constant_">PRIVATE_KEY</span>, encrypted);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(decrypted.<span class="title function_">toString</span>(<span class="string">&#x27;utf8&#x27;</span>) === password); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç§é’¥åŠ å¯†ã€å…¬é’¥è§£å¯†</span></span><br><span class="line"><span class="keyword">const</span> encrypted2 = crypto.<span class="title function_">privateEncrypt</span>(<span class="variable constant_">PRIVATE_KEY</span>, <span class="title class_">Buffer</span>.<span class="title function_">from</span>(password));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(encrypted2.<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>));</span><br><span class="line"><span class="keyword">const</span> decrypted2 = crypto.<span class="title function_">publicDecrypt</span>(<span class="variable constant_">PUBLIC_KEY</span>, encrypted2);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(decrypted2.<span class="title function_">toString</span>(<span class="string">&#x27;utf8&#x27;</span>) === password); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>è¿˜å¯ä»¥ä½¿ç”¨cryptoæ¨¡å—çš„<code>generateKeyPair</code>æ–¹æ³•åˆ›å»ºå…¬é’¥å’Œç§é’¥ï¼Œè¯¥æ–¹æ³•éœ€è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯:</p>
<ol>
<li>ç®—æ³•åç§°ï¼Œå¦‚<code>rsa</code>ã€<code>dsa</code>ã€<code>ecc</code>ç­‰</li>
<li>é…ç½®å¯¹è±¡ï¼ŒåŒ…æ‹¬<code>modulusLength</code>ã€<code>publicExponent</code>ã€<code>namedCurve</code>ç­‰</li>
<li>å›è°ƒå‡½æ•°ï¼Œç”¨äºæ¥æ”¶ç”Ÿæˆçš„å¯†é’¥å¯¹</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line">crypto.<span class="title function_">generateKeyPair</span>(<span class="string">&#x27;rsa&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">modulusLength</span>: <span class="number">2048</span>,</span><br><span class="line">  <span class="attr">publicKeyEncoding</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;spki&#x27;</span>,</span><br><span class="line">    <span class="attr">format</span>: <span class="string">&#x27;pem&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">privateKeyEncoding</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;pkcs8&#x27;</span>,</span><br><span class="line">    <span class="attr">format</span>: <span class="string">&#x27;pem&#x27;</span>,</span><br><span class="line">    <span class="attr">cipher</span>: <span class="string">&#x27;aes-256-cbc&#x27;</span>,</span><br><span class="line">    <span class="attr">passphrase</span>: <span class="string">&#x27;top secret&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="function">(<span class="params">err, publicKey, privateKey</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error generating key pair:&#x27;</span>, err);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Public Key:&#x27;</span>, publicKey);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Private Key:&#x27;</span>, privateKey);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆçš„å…¬é’¥å’Œç§é’¥å¯ä»¥ç›´æ¥ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚åŠ å¯†å’Œè§£å¯†çš„æ–¹å¼å’Œä¸Šé¢çš„æ–¹å¼ä¸€æ ·ã€‚</p>
<h2 id="ç­¾åç®—æ³•"><a href="#ç­¾åç®—æ³•" class="headerlink" title="ç­¾åç®—æ³•"></a>ç­¾åç®—æ³•</h2><p>è¿˜ç”¨ä¸€ç§å¸¸è§çš„ç®—æ³•æ˜¯ç­¾åç®—æ³•ã€‚<strong>ç­¾åç®—æ³•æ˜¯ä¸€ç§ç”¨äºéªŒè¯æ•°æ®å®Œæ•´æ€§å’Œæ¥æºçš„ç®—æ³•ï¼Œå¯ä»¥å¯¹æ•°æ®ç”Ÿæˆæ•°å­—ç­¾åï¼Œä»¥é˜²æ­¢åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ã€‚</strong>ç­¾åç®—æ³•å’Œå“ˆå¸Œç®—æ³•ç±»ä¼¼ï¼Œéƒ½æ˜¯å•å‘ä¸å¯é€†çš„ã€‚ä¸åŒçš„æ˜¯ï¼Œç­¾åç®—æ³•éœ€è¦ä½¿ç”¨ç§é’¥å¯¹æ•°æ®è¿›è¡Œç­¾åï¼Œç„¶åä½¿ç”¨å…¬é’¥å¯¹ç­¾åè¿›è¡ŒéªŒè¯ã€‚ä¸”<strong>åªèƒ½é€šè¿‡ç§é’¥ç­¾åï¼Œå…¬é’¥éªŒè¯ç­¾å</strong>ã€‚å¸¸è§çš„ç­¾åç®—æ³•æœ‰<strong>RSA</strong>ã€<strong>DSA</strong>ã€<strong>ECDSA</strong>ç­‰ã€‚ç­¾åç®—æ³•æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯æ•°å­—è¯ä¹¦å’ŒJWTï¼ˆJWTè§„èŒƒå¯å‚è€ƒğŸ‘‰<a target="_blank" rel="noopener external nofollow noreferrer" href="https://jwt.io/">è¿™é‡Œ</a>ï¼‰ã€‚JWTçš„ç¬¬ä¸‰éƒ¨åˆ†å°±æ˜¯ç­¾åï¼Œç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§å’Œæ¥æºã€‚</p>
<p>Nodejsçš„cryptoæ¨¡å—çš„ç­¾åç®—æ³•ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">PUBLIC_KEY</span> = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;public.pem&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PRIVATE_KEY</span> = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;private.pem&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> password = <span class="string">&#x27;qwertyuiop&#x27;</span>; <span class="comment">// æ˜æ–‡å¯†ç </span></span><br><span class="line"><span class="keyword">const</span> sign = crypto.<span class="title function_">createSign</span>(<span class="string">&#x27;RSA-SHA256&#x27;</span>) <span class="comment">// åˆ›å»ºç­¾åå¯¹è±¡, æŒ‡å®šç­¾åç®—æ³•ï¼Œå¸¸è§çš„ç­¾åç®—æ³•æœ‰RSA-SHA256ã€RSA-SHA512ã€DSA-SHA1ç­‰</span></span><br><span class="line">sign.<span class="title function_">update</span>(password); <span class="comment">// æŒ‡å®šç­¾åå†…å®¹</span></span><br><span class="line"><span class="keyword">const</span> signature = sign.<span class="title function_">sign</span>(<span class="variable constant_">PRIVATE_KEY</span>, <span class="string">&#x27;hex&#x27;</span>); <span class="comment">// ç”Ÿæˆç­¾åï¼Œä¹Ÿå¯ä»¥æŒ‡å®šè¾“å‡ºæ ¼å¼ä¸º&#x27;base64&#x27;ã€&#x27;base64url&#x27;ç­‰</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(signature);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> verify = crypto.<span class="title function_">createVerify</span>(<span class="string">&#x27;RSA-SHA256&#x27;</span>); <span class="comment">// åˆ›å»ºéªŒè¯å¯¹è±¡, æŒ‡å®šç®—æ³•ï¼Œå¿…é¡»å’Œç­¾åç®—æ³•ä¸€è‡´</span></span><br><span class="line">verify.<span class="title function_">update</span>(password); <span class="comment">// æŒ‡å®šéªŒè¯å†…å®¹</span></span><br><span class="line"><span class="keyword">const</span> result = verify.<span class="title function_">verify</span>(<span class="variable constant_">PUBLIC_KEY</span>, signature, <span class="string">&#x27;hex&#x27;</span>); <span class="comment">// éªŒè¯ç­¾åï¼Œä¹Ÿå¯ä»¥æŒ‡å®šè¾“å…¥æ ¼å¼ä¸º&#x27;base64&#x27;ã€&#x27;base64url&#x27;ç­‰</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h2 id="DHç®—æ³•"><a href="#DHç®—æ³•" class="headerlink" title="DHç®—æ³•"></a>DHç®—æ³•</h2><p>DHç®—æ³•æ˜¯ä¸€ç§å¯†é’¥äº¤æ¢ç®—æ³•ï¼Œè¯¥ç®—æ³•ä¸æ˜¯ç”¨æ¥åŠ å¯†æ•°æ®çš„ï¼Œè€Œæ˜¯åœ¨ä¸å®‰å…¨çš„ç½‘ç»œä¸­å®‰å…¨åœ°äº¤æ¢å¯†é’¥ã€‚DHç®—æ³•çš„å…¨ç§°æ˜¯Diffie-Hellmanç®—æ³•ï¼Œå®ƒçš„åŸç†æ˜¯é€šè¿‡æ•°å­¦è¿ç®—æ„é€ ä¸€ä¸ªå¤æ‚çš„æ•°å­¦éš¾é¢˜ï¼Œå¯¹è¯¥æ•°å­¦é—®é¢˜æ— æ³•åœ¨çŸ­æ—¶é—´å†…æœ‰æ•ˆçš„æ±‚è§£ã€‚DHç®—æ³•çš„è¿‡ç¨‹æ˜¯ï¼ŒåŒæ–¹å„è‡ªç”Ÿæˆä¸€å¯¹å…¬é’¥å’Œç§é’¥ï¼Œç„¶åé€šè¿‡å…¬é’¥äº¤æ¢ï¼Œæœ€åé€šè¿‡ç§é’¥è®¡ç®—å‡ºä¸€ä¸ªç›¸åŒçš„å¯†é’¥ã€‚è¿™ä¸ªå¯†é’¥åªæœ‰åŒæ–¹çŸ¥é“ï¼Œé»‘å®¢æ— æ³•çªƒå–ã€‚DHç®—æ³•çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dh1 = crypto.<span class="title function_">createDiffieHellman</span>(<span class="number">512</span>);</span><br><span class="line"><span class="keyword">const</span> prime = dh1.<span class="title function_">getPrime</span>(); <span class="comment">// è·å–ç´ æ•°</span></span><br><span class="line"><span class="keyword">const</span> generator = dh1.<span class="title function_">getGenerator</span>(); <span class="comment">// è·å–ç”Ÿæˆå™¨</span></span><br><span class="line"><span class="keyword">const</span> publicKey1 = dh1.<span class="title function_">generateKeys</span>(); <span class="comment">// ç”Ÿæˆå…¬é’¥</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Prime:&#x27;</span>, prime.<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Generator:&#x27;</span>, generator.<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Public Key1:&#x27;</span>, publicKey1.<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dh2 = crypto.<span class="title function_">createDiffieHellman</span>(prime, generator);</span><br><span class="line"><span class="keyword">const</span> publicKey2 = dh2.<span class="title function_">generateKeys</span>(); <span class="comment">// ç”Ÿæˆå…¬é’¥</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Public Key2:&#x27;</span>, publicKey2.<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> secret1 = dh1.<span class="title function_">computeSecret</span>(publicKey2); <span class="comment">// ç”Ÿæˆå¯†é’¥</span></span><br><span class="line"><span class="keyword">const</span> secret2 = dh2.<span class="title function_">computeSecret</span>(publicKey1); <span class="comment">// ç”Ÿæˆå¯†é’¥</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Secret1:&#x27;</span>, secret1.<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Secret2:&#x27;</span>, secret2.<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(secret1.<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>) === secret2.<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>)); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>åŒæ–¹ç”Ÿæˆç›¸åŒçš„å¯†é’¥ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨è¯¥å¯†é’¥é€šè¿‡å¯¹ç§°åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†é€šä¿¡äº†ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.xiabingbao.com/post/node/node-crypto.html">æ·±å…¥ç†è§£ node ä¸­çš„ crypto åŠ å¯†æ¨¡å—</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://liaoxuefeng.com/books/javascript/nodejs/basic-modules/crypto/">Node.js crypto æ¨¡å—</a></li>
</ul>


                

                <ul class="pager">
                    
                        <li class="previous"><a href="/å­¦ä¹ /ä»é›¶å®ç°ä¸€ä¸ªç®€æ˜“æ¨¡å—æ‰“åŒ…å™¨.html">&larr;  ä¸Šä¸€ç¯‡</a></li>
                    
                    
                        <li class="next"><a href="/å­¦ä¹ /ReactåŸç†ä¹‹ä»é›¶å®ç°ç®€æ˜“ç‰ˆReact.html">ä¸‹ä¸€ç¯‡ &rarr;</a></li>
                    
                </ul>
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>


    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/neilning-xc" rel="external nofollow noreferrer" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li>
                            <a href="mailto:ningcoder@foxmail.com" rel="external nofollow noreferrer" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2025 Neil Ning<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/" rel="external nofollow noreferrer">Clean Blog</a> from <a href="http://startbootstrap.com/" rel="external nofollow noreferrer" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/" rel="external nofollow noreferrer">Hexo</a> by <a href="http://www.codeblocq.com/" rel="external nofollow noreferrer" target="_blank">Jonathan Klughertz</a></p>
                <!-- <p class="copyright text-muted"><a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.miitbeian.gov.cn/">è±«ICPå¤‡19003046å·</a></p> -->
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//lib.baomitu.com/jquery/2.1.4/jquery.min.js"></script>

<!-- Bootstrap -->
<script src="//lib.baomitu.com/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//lib.baomitu.com/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>