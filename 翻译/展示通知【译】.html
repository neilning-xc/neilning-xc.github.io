<!DOCTYPE html>
<html lang="zh-CN">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="Tell the world with code"/>
    

    <!--Author-->
    
        <meta name="author" content="Neil Ning"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="展示通知【译】"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Tell the world with code"/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="Neil的博客"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="https://neilning-xc.github.io/img/banner.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="https://neilning-xc.github.io/img/banner.jpg"/>
    

    <!-- Title -->
    
    <title>展示通知【译】 - Neil的博客</title>

    <!-- Bootstrap Core CSS -->
    <link href="//lib.baomitu.com/twitter-bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//lib.baomitu.com/featherlight/1.3.5/featherlight.min.css" rel="stylesheet"/>

    <!-- Google Analytics -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPEMLKFYYW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ZPEMLKFYYW');
    </script>



    <!-- favicon -->
    

<meta name="generator" content="Hexo 5.4.2"></head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Neil的博客</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                首页
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                归档
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                标签
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                分类
                            
                        </a>
                    </li>
                
                    <li>
                        <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/neilning-xc/neilning-xc.github.io">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header post-header" style="background-image: url('展示通知【译】/bg.jpeg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>展示通知【译】</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                            Posted by Neil Ning on
                        
                        
                            2023-08-19
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/push-notification/">#push notification</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                        

<a href="/categories/翻译/">翻译</a>

                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>该文章翻译自web.dev的<a target="_blank" rel="noopener external nofollow noreferrer" href="https://web.dev/notifications/">Notifications</a>系列文章，本篇文章原文链接<a target="_blank" rel="noopener external nofollow noreferrer" href="https://web.dev/push-notifications-display-a-notification/">点击这里</a>。</p>
<p>通知的选项分为两部分，一部分处理可视化部分，本文将会讲解这一部分。另外一部分是关于通知行为的，将下一章节解释。<br>你可以在<a target="_blank" rel="noopener external nofollow noreferrer" href="https://tests.peter.sh/notification-generator/">这个网站</a>试验不同的通知选项在不同浏览器和平台上的差异。</p>
<h2 id="可视化选项"><a href="#可视化选项" class="headerlink" title="可视化选项"></a>可视化选项</h2><p>调用通知API来显示通知是很简单的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ServiceWorkerRegistration&gt;.showNotification(&lt;title&gt;, &lt;options&gt;);</span><br></pre></td></tr></table></figure>
<p>title和options参数都是可选的。title是字符串，options选项可以包含下面的字段：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;//&quot;: &quot;Visual Options&quot;,</span><br><span class="line">  &quot;body&quot;: &quot;&lt;String&gt;&quot;,</span><br><span class="line">  &quot;icon&quot;: &quot;&lt;URL String&gt;&quot;,</span><br><span class="line">  &quot;image&quot;: &quot;&lt;URL String&gt;&quot;,</span><br><span class="line">  &quot;badge&quot;: &quot;&lt;URL String&gt;&quot;,</span><br><span class="line">  &quot;dir&quot;: &quot;&lt;String of &#x27;auto&#x27; | &#x27;ltr&#x27; | &#x27;rtl&#x27;&gt;&quot;,</span><br><span class="line">  &quot;timestamp&quot;: &quot;&lt;Long&gt;&quot;</span><br><span class="line"></span><br><span class="line">  &quot;//&quot;: &quot;Both visual &amp; behavioral options&quot;,</span><br><span class="line">  &quot;actions&quot;: &quot;&lt;Array of Strings&gt;&quot;,</span><br><span class="line">  &quot;data&quot;: &quot;&lt;Anything&gt;&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;//&quot;: &quot;Behavioral Options&quot;,</span><br><span class="line">  &quot;tag&quot;: &quot;&lt;String&gt;&quot;,</span><br><span class="line">  &quot;requireInteraction&quot;: &quot;&lt;boolean&gt;&quot;,</span><br><span class="line">  &quot;renotify&quot;: &quot;&lt;Boolean&gt;&quot;,</span><br><span class="line">  &quot;vibrate&quot;: &quot;&lt;Array of Integers&gt;&quot;,</span><br><span class="line">  &quot;sound&quot;: &quot;&lt;URL String&gt;&quot;,</span><br><span class="line">  &quot;silent&quot;: &quot;&lt;Boolean&gt;&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下图可以看到相关的可视化选项：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/options.jpg" alt="options.jpg"></p>
<h3 id="title和options选项"><a href="#title和options选项" class="headerlink" title="title和options选项"></a>title和options选项</h3><p>下面是一个没有title和options选项时，Windows平台下Chrome浏览器里通知显示框：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/option1.jpg" alt="option1.jpg"><br>可以看到，浏览器的名称就是默认的title，“New notification”占位符是默认通知消息体。如果在设备上安装了渐进式Web应用，应用的名字将会替代浏览器名称：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/option3.jpg" alt="option3.jpg"><br>如果我们运行以下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Simple Title&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  body: &#x27;Simple piece of body text.\nSecond line of body text :)&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<p>在Linux的Chrome浏览器中，通知框的显示如下：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/option4.jpg" alt="option4.jpg"><br>在Linux的Firefox中显示如下：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/option5.jpg" alt="option5.jpg"></p>
<p>在Linux的Chrome中，超长title和body的通知框：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/option6.jpg" alt="option6.jpg"></p>
<p>在Linux的Firefox中body将会被折叠，当把浏览器光标放在通知框上时，body将会完整显示。<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/option7-1.jpg" alt="option7-1.jpg"><br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/option7.jpg" alt="option7.jpg"></p>
<p>Windows平台下的Firefox中，通知框的显示如下：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/option8.jpg" alt="option8.jpg"><br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/option9.jpg" alt="option9.jpg"></p>
<p>可以看到，相同的代码在不同的浏览器中显示效果是不同的，在不同平台的相同浏览器中显示效果也是不同的。Chrome和Firefox利用了操作系统中通知，例如在MacOS下的系统通知不支持图片和actions选项（快捷回复）。在所有系统下的Chrome浏览器可以自定义通知框。通过访问<a href="chrome://flags/#enable-system-notifications" rel="external nofollow noreferrer">chrome://flags/#enable-system-notifications</a>可以启用该选项。</p>
<h3 id="icon"><a href="#icon" class="headerlink" title="icon"></a>icon</h3><p><code>icon</code>选项本质上是一个小的图片，在代码中icon选项是一个URL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Icon Notification&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  icon: &#x27;/images/demos/icon-512x512.png&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<p>在Linux的Chrome中显示如下：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/icon.jpg" alt="icon.jpg"></p>
<p>在Linux的Firefox中显示如下：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/icon2.jpg" alt="icon2.jpg"><br>遗憾的是对于icon选项所支持的图片尺寸，还没有统一的规范。Android平台可以是一个64dp的图片（64px * 设备像素比）。假设最高的设备像素比是3。则至少需要192px的icon图标。</p>
<blockquote>
<p>一些浏览器要求icon图片的URL必须是HTTPS的，如果使用第三方图片，需要注意这一点。</p>
</blockquote>
<h3 id="Badge"><a href="#Badge" class="headerlink" title="Badge"></a>Badge</h3><p><code>badge</code>是一个小的单色图标，用来说明通知来自于哪里。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Badge Notification&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  badge: &#x27;/images/demos/badge-128x128.png&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<p>在写这边文章时，badge只能在Android的Chrome中使用。<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/badge.jpg" alt="badge.jpg"></p>
<p>在其他浏览器上（或没有badge选项的Chrome浏览器），显示的是浏览器的图标。<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/badge1.jpg" alt="badge1.jpg"><br>和<code>icon</code>选项一样，badge也没有统一的标准说明图片的尺寸。这片<a target="_blank" rel="noopener external nofollow noreferrer" href="https://developer.android.com/guide/practices/ui_guidelines/icon_design_status_bar.html">Android相关文章</a>推荐的是使用24px * 设备像素比。即72px的图片是最佳的尺寸（假设最高设备像素比是3）。</p>
<h3 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h3><p><code>image</code>选项用来向用户展示一个较大的图片。当你需要向用户展示预览图时候该选项是很有用的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Image Notification&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  image: &#x27;/images/demos/unsplash-farzad-nazifi-1600x1100.jpg&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<p>在Linux的Chrome浏览器中显示效果如下：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/image.jpg" alt="image.jpg"></p>
<p>在Android的Chrome中图片会被按比例裁剪：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/image2.jpg" alt="image2.jpg"></p>
<p>由于桌面或移动端平台比例的不同，所以很难有一个统一的标准。桌面版的Chrome浏览器的比例是4:3，并不会填充剩余空间，所以最佳的方式提供该比例的图片，并允许Android平台裁剪图片。Android平台可以使用450dp的图片。即只存为1350px的图片。</p>
<h3 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h3><p>可以定义<code>actions</code>选项展示不同的按钮。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Actions Notification&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  actions: [</span><br><span class="line">    &#123;</span><br><span class="line">      action: &#x27;coffee-action&#x27;,</span><br><span class="line">      type: &#x27;button&#x27;,</span><br><span class="line">      title: &#x27;Coffee&#x27;,</span><br><span class="line">      icon: &#x27;/images/demos/action-1-128x128.png&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      action: &#x27;doughnut-action&#x27;,</span><br><span class="line">      type: &#x27;button&#x27;,</span><br><span class="line">      title: &#x27;Doughnut&#x27;,</span><br><span class="line">      icon: &#x27;/images/demos/action-2-128x128.png&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      action: &#x27;gramophone-action&#x27;,</span><br><span class="line">      type: &#x27;button&#x27;,</span><br><span class="line">      title: &#x27;Gramophone&#x27;,</span><br><span class="line">      icon: &#x27;/images/demos/action-3-128x128.png&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      action: &#x27;atom-action&#x27;,</span><br><span class="line">      type: &#x27;button&#x27;,</span><br><span class="line">      title: &#x27;Atom&#x27;,</span><br><span class="line">      icon: &#x27;/images/demos/action-4-128x128.png&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<p>每个action可以定义<code>title</code>，<code>action</code>(本质上是个ID)、<code>icon</code>和<code>type</code>。title和icon会显示在通知框中，ID用来识别被点击的按钮。type可以省略，默认值是<code>&#39;button&#39;</code>。在写这篇文章时，只有Android的Chrome和Opera浏览器支持actions。<br>上面的例子中定义了四个action，你可以定义更多的action。如果想知道浏览器支持的action数量，可以查看<code>window.Notification?.maxActions</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const maxVisibleActions = window.Notification?.maxActions;</span><br><span class="line"></span><br><span class="line">if (maxVisibleActions) &#123;</span><br><span class="line">  options.body = `Up to $&#123;maxVisibleActions&#125; notification actions can be displayed.`;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  options.body = &#x27;Notification actions are not supported.&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在桌面端，action按钮可以显示图片的颜色：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/action-button.jpg" alt="action-button.jpg"></p>
<p>不过在Android6和之前的版本，图标的颜色必须匹配系统颜色：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/action-button1.jpg" alt="action-button1.jpg"></p>
<p>在Android7和之后的版本中，action的图标不会显示。</p>
<p>Chrome桌面浏览器有望实现像安装那样的行为，即随着系统的主题风格更改图标的颜色，现在，可以将图标的颜色设为<code>#333333</code>，来匹配Chrome浏览器中文字的颜色。桌面的Chrome浏览器中最佳的尺寸是24px * 24px。抹平这些平台差异的最佳实践如下：</p>
<ul>
<li>为图标设置一致的颜色，以保证对用户来说所有的图标颜色是一致的</li>
<li>确保Chrome中设置项能正常显示，其他的平台可能会有不同的展示方式</li>
<li>测试不同的尺寸，128px * 128px在我的安卓手机上显示正常，但是桌面浏览器的显示效果很差。</li>
<li>或者完全不展示action的图标</li>
</ul>
<h3 id="Actions（快捷回复）"><a href="#Actions（快捷回复）" class="headerlink" title="Actions（快捷回复）"></a>Actions（快捷回复）</h3><p>你可以定义action的type字段为<code>’text‘</code>，以实现在通知框中添加一个行内回复：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Alexey Rodionov&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  body: &#x27;How are you doing? )&#x27;,</span><br><span class="line">  image: &#x27;/images/demos/avatar-512x512.jpg&#x27;,</span><br><span class="line">  icon: &#x27;/images/demos/icon-512x512.png&#x27;,</span><br><span class="line">  badge: &#x27;/images/demos/badge-128x128.png&#x27;,</span><br><span class="line">  actions: [</span><br><span class="line">    &#123;</span><br><span class="line">      action: &#x27;reply&#x27;,</span><br><span class="line">      type: &#x27;text&#x27;,</span><br><span class="line">      title: &#x27;Reply&#x27;,</span><br><span class="line">      icon: &#x27;/images/demos/action-5-128x128.png&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<p>在Android中的显示效果如下：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/reply1.jpg" alt="reply1.jpg"></p>
<p>点击action的按钮会打开一个文本输入框：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/reply2.jpg" alt="reply2.jpg"><br>还可以自定义文本输入框的占位提示符：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Alexey Rodionov&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  body: &#x27;How are you doing? )&#x27;,</span><br><span class="line">  icon: &#x27;/images/demos/avatar-512x512.jpg&#x27;,</span><br><span class="line">  badge: &#x27;/images/demos/badge-128x128.png&#x27;,</span><br><span class="line">  actions: [</span><br><span class="line">    &#123;</span><br><span class="line">      action: &#x27;reply&#x27;,</span><br><span class="line">      type: &#x27;text&#x27;,</span><br><span class="line">      title: &#x27;Reply&#x27;,</span><br><span class="line">      icon: &#x27;/images/demos/action-5-128x128.png&#x27;,</span><br><span class="line">      placeholder: &#x27;Type text here&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<p><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/reply3.jpg" alt="reply3.jpg"><br>在Windows的Chrome中，文本输入框会直接显示出来，而没有按钮：</p>
<p><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/reply4.jpg" alt="reply4.jpg"></p>
<p>你还可以添加多个行内快捷回复或者添加一个按钮和一个快捷回复：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Poll&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  body: &#x27;Do you like this photo?&#x27;,</span><br><span class="line">  image: &#x27;/images/demos/cat-image.jpg&#x27;,</span><br><span class="line">  icon: &#x27;/images/demos/icon-512x512.png&#x27;,</span><br><span class="line">  badge: &#x27;/images/demos/badge-128x128.png&#x27;,</span><br><span class="line">  actions: [</span><br><span class="line">    &#123;</span><br><span class="line">      action: &#x27;yes&#x27;,</span><br><span class="line">      type: &#x27;button&#x27;,</span><br><span class="line">      title: &#x27;👍 Yes&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      action: &#x27;no&#x27;,</span><br><span class="line">      type: &#x27;text&#x27;,</span><br><span class="line">      title: &#x27;👎 No (explain why)&#x27;,</span><br><span class="line">      placeholder: &#x27;Type your explanation here&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<p><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/reply5.jpg" alt="reply5.jpg"></p>
<h3 id="对齐方式"><a href="#对齐方式" class="headerlink" title="对齐方式"></a>对齐方式</h3><p>dir参数可以允许定义文字的对齐方式，右对齐或者左对齐。在测试过程中，文字的对齐方式似乎是由文字决定的，而不是该参数，不过根据规范，该参数还可以设置action相关选项的对齐方式。你可以显示的设置该字段，或者由浏览器根据当前的文字决定展示的对齐方式。该参数支持的值有<code>auto</code>， <code>ltr</code>, <code>rtl</code>。<br>在Linux的Chrome中右对齐的语言显示效果如下：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/alb1.jpg" alt="alb1.jpg"></p>
<p>在Firefox中的显示效果如下：<br><img src="/%E7%BF%BB%E8%AF%91/%E5%B1%95%E7%A4%BA%E9%80%9A%E7%9F%A5%E3%80%90%E8%AF%91%E3%80%91/alb.jpg" alt="alb.jpg"></p>
<h3 id="抖动"><a href="#抖动" class="headerlink" title="抖动"></a>抖动</h3><p><code>vibrate</code>选项允许你定义一个抖动模式，当通知框展示的时候会有抖动的效果，不过这需要用户的设备允许抖动（例如设备处于非静音模式）。vibrate选项的格式是个由数字组成的数组，第一个数字表示震动的毫秒数，紧接着第二个数字是非抖动的毫秒数，以此类推。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Vibrate Notification&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  // Star Wars shamelessly taken from the awesome Peter Beverloo</span><br><span class="line">  // https://tests.peter.sh/notification-generator/</span><br><span class="line">  vibrate: [</span><br><span class="line">    500, 110, 500, 110, 450, 110, 200, 110, 170, 40, 450, 110, 200, 110, 170,</span><br><span class="line">    40, 500,</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<p>该选项只支持某些特定的设备。</p>
<h3 id="声音"><a href="#声音" class="headerlink" title="声音"></a>声音</h3><p><code>sound</code>选项允许你定义提示音，当消息框展示时，提示音会播放，写这篇文章时，还没有浏览器支持该选项。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Sound Notification&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  sound: &#x27;/demos/notification-examples/audio/notification-sound.mp3&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<h3 id="时间戳"><a href="#时间戳" class="headerlink" title="时间戳"></a>时间戳</h3><p>timestamp选项允许你定义推送事件的发生时间，该选项是一个UNIX时间戳的毫秒数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const title = &#x27;Timestamp Notification&#x27;;</span><br><span class="line"></span><br><span class="line">const options = &#123;</span><br><span class="line">  body: &#x27;Timestamp is set to &quot;01 Jan 2000 00:00:00&quot;.&#x27;,</span><br><span class="line">  timestamp: Date.parse(&#x27;01 Jan 2000 00:00:00&#x27;),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">registration.showNotification(title, options);</span><br></pre></td></tr></table></figure>
<h2 id="用户体验的最佳实践"><a href="#用户体验的最佳实践" class="headerlink" title="用户体验的最佳实践"></a>用户体验的最佳实践</h2><p>我见过最差的用户体验是展示的通知框不包含任何有用的信息。你应该考虑你为什么要发送消息，并确保利用所有的选项来帮助用户理解他们为什么要读这个通知。不过，坦白地讲，人们很容易的认为自己不会犯同样的错误，但是又很容易掉入这些陷阱中。下面是一些可以避免的错误：</p>
<ul>
<li>不要将你的网址放在title和body中，浏览器的通知框已经包含了你的域名，所以没有必要重复。</li>
<li>尽可能多的展示可利用的信息，例如当你需要展示某个用户发送的消息时，不要使用你有“一条新消息”和“点击阅读”作为title和body，而使用”John发给你一条消”息作为title，并把消息的一部分作为body.</li>
</ul>
<h2 id="浏览器特性检测"><a href="#浏览器特性检测" class="headerlink" title="浏览器特性检测"></a>浏览器特性检测</h2><p>写这篇文章时，Chrome浏览器和Firefox浏览器通知选项的支持度方面还有较大的差异。幸运的是，你可以使用<code>window.Notification</code>的原型来检测浏览器是否支持某个选项。假设我们想知道浏览器通知是否支持action按钮，我们可以使用下面的代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if (&#x27;actions&#x27; in window.Notification?.prototype) &#123;</span><br><span class="line">  // Action buttons are supported.</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  // Action buttons are NOT supported.</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样我们就能在不同的浏览器中展示不同的效果，检测其他特性的方式只需要将<code>&#39;action&#39;</code>替换成其他选项即可。</p>


                

                <ul class="pager">
                    
                        <li class="previous"><a href="/学习/Web-Push-Notification教程（一）.html">&larr;  上一篇</a></li>
                    
                    
                        <li class="next"><a href="/翻译/推送事件【译】.html">下一篇 &rarr;</a></li>
                    
                </ul>
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>


    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/neilning-xc" rel="external nofollow noreferrer" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li>
                            <a href="mailto:ningcoder@foxmail.com" rel="external nofollow noreferrer" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2025 Neil Ning<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/" rel="external nofollow noreferrer">Clean Blog</a> from <a href="http://startbootstrap.com/" rel="external nofollow noreferrer" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/" rel="external nofollow noreferrer">Hexo</a> by <a href="http://www.codeblocq.com/" rel="external nofollow noreferrer" target="_blank">Jonathan Klughertz</a></p>
                <!-- <p class="copyright text-muted"><a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.miitbeian.gov.cn/">豫ICP备19003046号</a></p> -->
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//lib.baomitu.com/jquery/2.1.4/jquery.min.js"></script>

<!-- Bootstrap -->
<script src="//lib.baomitu.com/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//lib.baomitu.com/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>